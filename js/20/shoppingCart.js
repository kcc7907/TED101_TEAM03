let delAll=document.querySelector(".delAll"),checkAll=document.querySelector(".checkAll"),title=document.querySelectorAll(".title");title[0].classList.add("-onColor"),window.addEventListener("storage",()=>location.reload());let right=new Vue({el:"#right",data:{total:0,discount:0,Shipping:0,final:0,proTotal:0},methods:{backShop(){pop.text="是否返回商城?",pop.show=!0,pop.confirm="backShop"},loginCheck(){0==this.proTotal?(pop.text="請先購買商品",pop.show=!0):checkCookie("loging")?(pop.text="是否確定購買?",pop.show=!0,pop.confirm="buy"):($("div#login").show().css("zIndex","4"),$("div#login div.login").css({opacity:"1",top:"0"}),setTimeout(()=>{logAni()},500),$(".icon >a , a.signLink").click((function(t){t.preventDefault()})),$("a.signLink").click((function(){signBox(),$("form input").css({backgroundColor:"rgba(0, 0, 0, 0)",border:"none",borderBottom:"1px solid #BDA79E"}),$("form select").css("border","1px solid #BDA79E"),$("#alivebox").removeClass("bcgColor")})),$("a.logLink").click((function(t){backToLog(),$("form input").css({backgroundColor:"rgba(0, 0, 0, 0)",border:"none",borderBottom:"1px solid #BDA79E"}),$("form select").css("border","1px solid #BDA79E")})),$("div.closebtn").click((function(t){let e=t.target;closeLB(e)})))},buy(){localStorage.removeItem("lists");let t=document.querySelectorAll(".product li"),e=[];t.forEach((t,s)=>{let i={prd_id:t.getAttribute("data-id"),num:t.getAttribute("data-num"),prd_price:t.getAttribute("data-price"),prd_name:t.getAttribute("data-name")};e.push(i)}),localStorage.setItem("lists",JSON.stringify(e)),localStorage.setItem("discount",this.discount),location.href="shoppingOrder.php"}},watch:{total(){this.final=this.total+this.discount}},mounted(){}}),all=new Vue({el:"#all",data:{},methods:{delCheck(){pop.text="是否刪除選擇商品?",pop.show=!0,pop.confirm="deleteChecked"},deleteAll(t){let e=document.querySelectorAll(".pick"),s=[];e.forEach((t,e)=>{if(!0===t.checked)right.total-=t.closest("li").getAttribute("data-price")*t.closest("li").getAttribute("data-num"),t.closest("ul").removeChild(t.closest("li")),right.proTotal-=t.closest("li").getAttribute("data-num");else{let e={prd_id:t.closest("li").getAttribute("data-id"),num:t.closest("li").getAttribute("data-num")};s.push(e)}}),localStorage.removeItem("lists"),localStorage.setItem("lists",JSON.stringify(s));let i=JSON.parse(localStorage.getItem("lists")),o=document.querySelector(".shop"),r=0;if(i.forEach(t=>{r+=parseInt(t.num)}),0===r)return!1;o.classList.contains("shopnum")?o.setAttribute("data-content",r):(o.setAttribute("data-content",r),o.classList.add("shopnum"))},checkAll(t){1==t.target.checked?left.check=!0:left.check=!1}}}),left=new Vue({el:"#list",data:{check:!1,prdid:[],rp:[],proTotal:0,discount_list:[],discount_inner:[],discount_specie:[],disA:!1,disB:!1,disShow:!1,disArrA:[],disArrB:[]},created(){let t=JSON.parse(localStorage.getItem("lists"));if(t&&0!==t.length)t.forEach((t,e)=>{this.prdid.push(t.prd_id),right.proTotal+=parseInt(t.num)}),axios.post("../php/20/getProduct.php",this.prdid).then(t=>{this.rp=t.data}).catch(t=>{t.response?console.log(t.response.status):t.request?console.log(t.request):console.log("Error",t.message)}),axios.post("../php/20/getDiscount.php").then(t=>{let e,s;this.discount_list=t.data,this.discount_list.forEach((t,e)=>{this.discount_specie.push(t.DIS_ID),this.discount_inner.push(t.DIS_PRODUCT_ID1),this.discount_inner.push(t.DIS_PRODUCT_ID2)}),this.discount_inner.forEach((t,i)=>{let o=this.rp.filter((e,s)=>e.PRD_NAME==t);o.length&&(e?e===o[0].DISCOUNT_ID?e+=o[0].DISCOUNT_ID:s?s+=o[0].DISCOUNT_ID:s=o[0].DISCOUNT_ID:e=o[0].DISCOUNT_ID)}),e&&(e.length>1&&(this.disA=!0),this.disArrA=e),s&&(s.length>1&&(this.disB=!0),this.disArrB=s)});else{document.querySelector(".left").style.borderBottom="1px solid #465d4c"}},watch:{disA(){1==this.disA?right.discount-=500:right.discount+=500},disB(){1==this.disB?right.discount-=2500:right.discount+=2500,right.final=right.total+right.discount},disArrA(){this.disArrA.length<1&&(this.disA=!1)},disArrB(){this.disArrB.length<1&&(this.disB=!1)}}});Vue.component("myList",{data:()=>({num:1}),props:["mycheck","prdId","url","prdName","prdPrice","discountId","prdMtl","myindex"],template:'<li class="list" :data-id="prdId" :data-price="prdPrice" :data-num="num" :data-dis="discountId"　:data-name="prdName">\n                <input type="checkbox" class="pick" :checked="mycheck">\n                <div class="picbox">\n                    <div class="imgbox">\n                        <img :src="url" class="pic">\n                        <div class="tag" v-show="discountId">\n                            <p>{{discountId}}</p>\n                        </div>\n                    </div>\n                </div>\n                <div class="discountbox">\n                    <div class="discount" v-show="discountId">\n                        <div class="tag">\n                            <p>{{discountId}}</p>\n                        </div>\n                        <p>{{discountId==\'A\'?\'狂熱桌椅組\':\'跳樓桌椅組\'}}</p>\n                    </div>\n                </div>\n                <div class="info">\n                    <div class="procduct_name" >\n                        <p>{{prdName}}</p>\n                    </div>\n                    <div class="material" v-show="prdMtl">\n                        <p>黑色</p>\n                    </div>\n                    <div class="pricebox">\n                        <p class="dollar">$</p>\n                        <p class="price">{{prdPrice}}</p>\n                    </div>\n                </div>\n                <div class="count">\n                    <div class="totalbox">\n                        <p class="dollar">$</p>\n                        <p class="price_total">{{prdPrice}}</p>\n                    </div>\n                    <div class="numbox">\n                        <div class="arrowl"><img src="../img/shoppincart/left-G.svg" alt="" @click=\'btnl\'></div>\n                        <input type="number" class="num" :value="num" disabled>\n                        <div class="arrowr"><img src="../img/shoppincart/right-G.svg" alt="" @click=\'btnr\'>\n                        </div>\n                    </div>\n                </div>\n                <img src="../img/shoppincart/trash.svg" alt="" class="trash" @click=\'deleteList\'>\n            </li>',methods:{btnl(t){this.num>1&&(this.num--,right.total-=parseInt(this.prdPrice),right.proTotal--)},btnr(){this.num++,right.total+=parseInt(this.prdPrice),right.proTotal++},deleteList(t){this.$el.classList.add("slide-fade-leave-active"),this.$el.classList.add("slide-fade-leave-to"),this.$el.addEventListener("transitionend",()=>{let t=JSON.parse(localStorage.getItem("lists")),e=[];switch(t.forEach(t=>{this.prdId!=t.prd_id&&e.push(t)}),this.$el.getAttribute("data-dis")){case"A":0!=left.disArrA.length&&(left.disArrA=left.disArrA.replace("A",""));break;case"B":if(0!=left.disArrB.length){left.disArrB=left.disArrB.replace("B","");break}}localStorage.setItem("lists",JSON.stringify(e)),this.$destroy(),this.$el.parentNode.removeChild(this.$el),right.total=right.total-this.prdPrice*this.num,right.proTotal-=this.num;let s=JSON.parse(localStorage.getItem("lists")),i=document.querySelector(".shop"),o=0;if(s.forEach(t=>{o+=parseInt(t.num)}),0===o)return!1;i.classList.contains("shopnum")?i.setAttribute("data-content",o):(i.setAttribute("data-content",o),i.classList.add("shopnum"))})}},mounted(){JSON.parse(localStorage.getItem("lists")).forEach((t,e)=>{this.prdId===t.prd_id&&(this.num=t.num)}),right.total+=parseInt(this.prdPrice)*this.num}});